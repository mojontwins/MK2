;BeepFX player by Shiru
;You are free to do whatever you want with this code



playBasic:
	ld a,0
sample_play:
	ld hl,sfxData	;address of sound effects data

	push ix
	push iy

	ld b,0
	ld c,a
	add hl,bc
	add hl,bc
	ld e,(hl)
	inc hl
	ld d,(hl)
	push de
	pop ix			;put it into ix

	

readData:
	ld a,(ix+0)		;read block type
	ld c,(ix+1)		;read duration 1
	ld b,(ix+2)
	ld e,(ix+3)		;read duration 2
	ld d,(ix+4)
	push de
	pop iy

	dec a
	
	dec a
	
	dec a
	jr z,sfxRoutineSample
	pop iy
	pop ix
	ret

;play sample

sfxRoutineSample:
	ex de,hl
sfxRS0:
	ld e,8
	ld d,(hl)
	inc hl
sfxRS1:
	ld a,(ix+5)
sfxRS2:
	dec a
	jr nz,sfxRS2
	rl d
	sbc a,a
	and 16
sfxRoutineSampleBorder:
	out (254),a
	dec e
	jr nz,sfxRS1
	dec bc
	ld a,b
	or c
	jr nz,sfxRS0

	ld c,6
	
nextData:
	add ix,bc		;skip to the next block
	jr readData


sfxData:

SoundEffectsData:
	defw SoundEffect0Data

SoundEffect0Data:
	defb 3 ;sample
	defw 480
	defw Sample0Data+0
	defb 8
	defb 0

Sample0Data:
	defb 255,255,255,255,255,255,255,239,255,255,255,255,255,255,255,255
	defb 255,255,255,255,255,255,255,255,199,255,255,252,63,255,255,195
	defb 252,127,254,31,239,255,225,255,63,254,15,251,255,225,255,255
	defb 254,31,255,255,241,255,255,255,3,255,255,225,253,255,254,15
	defb 195,255,193,248,127,252,63,7,255,225,240,127,255,15,193,255
	defb 252,63,15,255,224,248,63,255,135,225,255,254,31,7,255,240
	defb 252,63,255,199,241,255,255,15,131,255,248,124,31,255,225,240
	defb 127,254,31,135,255,240,252,31,255,131,224,255,252,31,7,255
	defb 225,248,63,255,15,193,255,248,126,15,255,193,243,255,248,62
	defb 15,255,224,241,255,248,126,31,255,195,240,255,254,31,7,255
	defb 195,225,255,252,62,31,255,195,224,255,248,124,63,254,31,135
	defb 255,224,248,63,254,62,31,255,15,195,255,240,248,63,252,62
	defb 63,254,31,135,255,193,240,127,249,252,127,248,126,15,255,15
	defb 143,255,15,199,255,240,253,255,248,126,255,252,63,31,255,31
	defb 255,255,143,207,255,199,255,255,199,255,255,227,255,255,227,255
	defb 255,227,255,255,225,255,255,243,255,255,241,255,255,227,255,255
	defb 241,159,255,227,159,255,243,159,255,227,159,255,227,159,255,243
	defb 159,255,227,159,255,227,159,255,243,159,255,243,159,255,227,159
	defb 255,243,159,255,243,159,255,243,143,255,243,143,255,243,143,255
	defb 241,143,255,249,143,255,241,143,255,249,199,255,252,199,255,252
	defb 195,255,252,227,255,254,97,255,255,56,255,255,152,111,255,156
	defb 119,255,238,59,255,243,31,255,249,142,255,254,195,127,255,113
	defb 159,255,220,199,255,255,25,255,251,140,127,255,227,31,255,248
	defb 199,255,255,25,255,255,198,63,255,248,143,255,254,49,255,255
	defb 196,63,255,248,135,255,255,152,255,255,241,15,255,255,0,255
	defb 255,240,15,255,255,8,255,255,248,199,255,255,224,63,255,255
	defb 8,255,255,254,35,255,255,252,71,255,255,248,143,255,255,248
	defb 143,255,255,243,31,255,255,252,135,255,255,255,1,255,255,255
	defb 196,63,255,255,248,7,255,255,255,128,255,255,255,254,15,255
	defb 255,255,254,255,255,255,255,255,255,255,255,255,255,255,255,255
